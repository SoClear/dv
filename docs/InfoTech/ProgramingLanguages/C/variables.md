# 变量

变量其实只不过是程序可操作的存储区的名称。C 中每个变量都有特定的类型，类型决定了变量存储的大小和布局，该范围内的值都可以存储在内存中，运算符可应用于变量上。

变量的名称可以由字母、数字和下划线字符组成。它必须以字母或下划线开头。大写字母和小写字母是不同的，因为 C 是大小写敏感的。

C 是大小写敏感的。基于前一章讲解的基本类型，有以下几种基本的变量类型：

| 类型   | 描述                                                                                      |
| ------ | ----------------------------------------------------------------------------------------- |
| char   | 通常是一个字节（八位）, 这是一个整数类型。                                                |
| int    | 整型，4 个字节，取值范围 -2147483648 到 2147483647。                                      |
| float  | 单精度浮点值。单精度是这样的格式，1位符号，8位指数，23位小数。  ![float](variables_1.png) |
| double | 双精度浮点值。双精度是1位符号，11位指数，52位小数。                                       |
| void   | 表示类型的缺失                                                                            |

C 语言也允许定义各种其他类型的变量，比如枚举、指针、数组、结构、共用体等等，这将会在后续的章节中进行讲解，本章节我们先讲解基本变量类型。

## C 中的变量定义

变量定义就是告诉编译器在何处创建变量的存储，以及如何创建变量的存储。变量定义指定一个数据类型，并包含了该类型的一个或多个变量的列表，如下所示：

```c
type variable_list;
```

**type** 表示变量的数据类型，可以是整型、浮点型、字符型、指针等，也可以是用户自定义的对象。

**variable_list** 可以由一个或多个变量的名称组成，多个变量之间用逗号,分隔，变量由字母、数字和下划线组成，且以字母或下划线开头。

下面列出几个有效的声明：

定义整型变量：

```c
int age;
```

以上代码中，age 被定义为一个整型变量。

定义浮点型变量：

```c
float salary;
```

以上代码中，salary 被定义为一个浮点型变量。

定义字符型变量：

```c
char grade;
```

以上代码中，grade 被定义为一个字符型变量。

定义指针变量：

```c
int *ptr;
```

以上代码中，ptr 被定义为一个整型指针变量。

定义多个变量：

```c
int i, j, k;
```

**int i, j, k;** 声明并定义了变量 **i、j 和 k**，这指示编译器创建类型为 **int** 的名为 **i、j、k** 的变量。

### 变量初始化

在 C 语言中，变量的初始化是在定义变量的同时为其赋予一个初始值。变量的初始化可以在定义时进行，也可以在后续的代码中进行。

初始化器由一个等号，后跟一个常量表达式组成，如下所示：

```c
type variable_name = value;
```

其中，**type** 表示变量的数据类型，**variable_name** 是变量的名称，**value** 是变量的初始值。

下面列举几个实例：

```c
int x = 10;         // 整型变量 x 初始化为 10
float pi = 3.14;    // 浮点型变量 pi 初始化为 3.14
char ch = 'A';      // 字符型变量 ch 初始化为字符 'A'
int d = 3, f = 5;           // 定义并初始化 d 和 f

// 声明外部变量
extern int d;
extern int f;
```

**后续初始化变量：**

在变量定义后的代码中，可以使用赋值运算符 \= 为变量赋予一个新的值。

```c
type variable_name;    // 变量定义
variable_name = new_value;    // 变量初始化
```

实例如下：

```c
int x;          // 整型变量x定义
x = 20;         // 变量x初始化为20
float pi;       // 浮点型变量pi定义
pi = 3.14159;   // 变量pi初始化为3.14159
char ch;        // 字符型变量ch定义
ch = 'B';       // 变量ch初始化为字符'B'
```

需要注意的是，变量在使用之前应该被初始化。未初始化的变量的值是未定义的，可能包含任意的垃圾值。因此，为了避免不确定的行为和错误，建议在使用变量之前进行初始化。

### 变量不初始化

在 C 语言中，如果变量没有显式初始化，那么它的默认值将取决于该变量的类型和其所在的作用域。

对于全局变量和静态变量（在函数内部定义的静态变量和在函数外部定义的全局变量），它们的默认初始值为零。

以下是不同类型的变量在没有显式初始化时的默认值：

- 整型变量（int、short、long等）：默认值为0。
- 浮点型变量（float、double等）：默认值为0.0。
- 字符型变量（char）：默认值为'\\0'，即空字符。
- 指针变量：默认值为NULL，表示指针不指向任何有效的内存地址。
- 数组、结构体、联合等复合类型的变量：它们的元素或成员将按照相应的规则进行默认初始化，这可能包括对元素递归应用默认规则。

需要注意的是，局部变量（在函数内部定义的非静态变量）不会自动初始化为默认值，它们的初始值是未定义的（包含垃圾值）。因此，在使用局部变量之前，应该显式地为其赋予一个初始值。

总结起来，C 语言中变量的默认值取决于其类型和作用域。全局变量和静态变量的默认值为 **0**，字符型变量的默认值为 \\0，指针变量的默认值为 NULL，而局部变量没有默认值，其初始值是未定义的。

## C 中的变量声明

变量声明向编译器保证变量以指定的类型和名称存在，这样编译器在不需要知道变量完整细节的情况下也能继续进一步的编译。变量声明只在编译时有它的意义，在程序连接时编译器需要实际的变量声明。

变量的声明有两种情况：

- 1、一种是需要建立存储空间的。例如：`int a` 在声明的时候就已经建立了存储空间。
- 2、另一种是不需要建立存储空间的，通过使用`extern`关键字声明变量名而不定义它。 例如：`extern int a` 其中变量 `a` 可以在别的文件中定义的。
- 除非有`extern`关键字，否则都是变量的定义。

```c
extern int i; //声明，不是定义
int i; //声明，也是定义
```

尝试下面的实例，其中，变量在头部就已经被声明，但是定义与初始化在主函数内：

```c
#include <stdio.h>
 
// 函数外定义变量 x 和 y
int x;
int y;
int addtwonum()
{
    // 函数内声明变量 x 和 y 为外部变量
    extern int x;
    extern int y;
    // 给外部变量（全局变量）x 和 y 赋值
    x = 1;
    y = 2;
    return x+y;
}
 
int main()
{
    int result;
    // 调用函数 addtwonum
    result = addtwonum();
    
    printf("result 为: %d",result);
    return 0;
}
```

当上面的代码被编译和执行时，它会产生下列结果：

```text
result 为: 3
```

如果需要在一个源文件中引用另外一个源文件中定义的变量，我们只需在引用的文件中将变量加上 extern 关键字的声明即可。

addtwonum.c 文件代码：

```c
#include <stdio.h>
/*外部变量声明*/
extern int x ;
extern int y ;
int addtwonum()
{
    return x+y;
}
```

test.c 文件代码：

```c
#include <stdio.h>
  
/*定义两个全局变量*/
int x=1;
int y=2;
int addtwonum();
int main(void)
{
    int result;
    result = addtwonum();
    printf("result 为: %d\n",result);
    return 0;
}
```

当上面的代码被编译和执行时，它会产生下列结果：

```shell
$ gcc addtwonum.c test.c -o main
$ ./main
result 为: 3
```

## C 中的左值（Lvalues）和右值（Rvalues）

C 中有两种类型的表达式：

1. **左值（lvalue）：** 指向内存位置的表达式被称为左值（lvalue）表达式。左值可以出现在赋值号的左边或右边。
2. **右值（rvalue）：** 术语右值（rvalue）指的是存储在内存中某些地址的数值。右值是不能对其进行赋值的表达式，也就是说，右值可以出现在赋值号的右边，但不能出现在赋值号的左边。

变量是左值，因此可以出现在赋值号的左边。数值型的字面值是右值，因此不能被赋值，不能出现在赋值号的左边。下面是一个有效的语句：

```c
int g = 20;
```

但是下面这个就不是一个有效的语句，会生成编译时错误：

```c
10 = 20;
```
